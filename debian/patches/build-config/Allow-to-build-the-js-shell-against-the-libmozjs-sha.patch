From: Mike Hommey <glandium@debian.org>
Date: Wed, 1 Jul 2009 07:54:41 +0200
Subject: Allow to build the js shell against the libmozjs shared library

https://bugzilla.mozilla.org/show_bug.cgi?id=501300
---
 js/src/jstracer.cpp |    4 ++++
 js/src/shell/js.cpp |    2 +-
 2 files changed, 5 insertions(+), 1 deletions(-)

diff --git a/js/src/jstracer.cpp b/js/src/jstracer.cpp
index be79d3f..39afe0f 100644
--- a/js/src/jstracer.cpp
+++ b/js/src/jstracer.cpp
@@ -241,7 +241,11 @@ JSClass jitstats_class = {
     JSCLASS_NO_OPTIONAL_MEMBERS
 };
 
+#ifdef DEBUG
+JS_FRIEND_API(void)
+#else
 void
+#endif
 js_InitJITStatsClass(JSContext *cx, JSObject *glob)
 {
     JS_InitClass(cx, glob, NULL, &jitstats_class, NULL, 0, jitstats_props, NULL, NULL, NULL);
diff --git a/js/src/shell/js.cpp b/js/src/shell/js.cpp
index 42e86cd..8beadc0 100644
--- a/js/src/shell/js.cpp
+++ b/js/src/shell/js.cpp
@@ -725,7 +725,7 @@ ProcessArgs(JSContext *cx, JSObject *obj, char **argv, int argc)
             JS_ToggleOptions(cx, JSOPTION_JIT);
 #if defined(JS_TRACER) && defined(DEBUG)
 extern struct JSClass jitstats_class;
-extern void js_InitJITStatsClass(JSContext *cx, JSObject *glob);
+extern JS_FRIEND_API(void) js_InitJITStatsClass(JSContext *cx, JSObject *glob);
             js_InitJITStatsClass(cx, JS_GetGlobalObject(cx));
             JS_DefineObject(cx, JS_GetGlobalObject(cx), "tracemonkey",
                             &jitstats_class, NULL, 0);
