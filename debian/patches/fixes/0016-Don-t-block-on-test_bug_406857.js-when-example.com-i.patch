From: Mike Hommey <mh@glandium.org>
Date: Mon, 22 Mar 2010 11:44:29 +0100
Subject: Don't block on test_bug_406857.js when example.com is not reachable

https://bugzilla.mozilla.org/show_bug.cgi?id=553995
---
 .../downloads/test/unit/test_bug_406857.js         |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/toolkit/components/downloads/test/unit/test_bug_406857.js b/toolkit/components/downloads/test/unit/test_bug_406857.js
index 88df501..d937160 100644
--- a/toolkit/components/downloads/test/unit/test_bug_406857.js
+++ b/toolkit/components/downloads/test/unit/test_bug_406857.js
@@ -44,13 +44,15 @@ function run_test()
   let dm = Cc["@mozilla.org/download-manager;1"].
            getService(Ci.nsIDownloadManager);
   let db = dm.DBConnection;
+  var httpserv = new nsHttpServer();
+  httpserv.start(4444);
 
   let stmt = db.createStatement(
     "INSERT INTO moz_downloads (source, target, state, referrer) " +
     "VALUES (?1, ?2, ?3, ?4)");
 
   // Download from the test http server
-  stmt.bindStringParameter(0, "http://example.com/httpd.js");
+  stmt.bindStringParameter(0, "http://localhost:4444/httpd.js");
 
   // Download to a temp local file
   let file = Cc["@mozilla.org/file/directory_service;1"].
